<!DOCTYPE html>
<html>
<head>
  <title>Blog Index</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
</head>
<body>
  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center">
    <h3 class="mb-4">Blog Posts</h3>
      <% if user_signed_in? %>
        <%= link_to new_post_path, class: 'btn btn-success-custom mb-4' do %>
          <i class="fa fa-plus"></i> New Post
        <% end %>
      <% end %>
    </div>


    <div class="list-group">
      <% @posts.each do |post| %>
        <div class="list-group-item list-group-item-action">
          <div class="d-flex justify-content-between align-items-center">
            <div class="text-start">
              <h5 class="mb-1 post-title"><%= link_to post.title, post_path(post) %></h5>
              <p class="mb-1"><%= truncate(post.content, length: 150) %></p>
              <small class="secondary-text">Published on <%= post.published_date.strftime('%B %d, %Y') %></small>
            </div>
            <% if post.user == current_user %>
              <div class="text-end gap-2 d-flex">
                <%= link_to edit_post_path(post), class: 'btn btn-warning', title: 'Edit Post', data: { toggle: 'tooltip' } do %>
                  <i class="fa fa-pencil-alt"></i>
                <% end %>
                <%= link_to post_path(post), method: :delete, data: { confirm: 'Are you sure you want to delete this post?', toggle: 'tooltip' }, title: 'Delete Post', class: 'btn btn-danger' do %>
                  <i class="fa fa-trash-alt"></i>
                <% end %>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</body>
</html>
